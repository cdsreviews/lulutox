<script>
    (function () {
        // 解码函数
        function safeDecode(value) {
            try {
                const once = decodeURIComponent(value);
                const twice = decodeURIComponent(once);
                return twice;
            } catch (e) {
                try {
                    return decodeURIComponent(value);
                } catch (err) {
                    return value;
                }
            }
        }

        // 获取 URL 参数并尝试多层解码
        function getURLParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            const rawValue = urlParams.get(name);
            return rawValue ? safeDecode(rawValue) : null;
        }

        // 先尝试从 URL 获取 ScCid 参数
        const urlScCid = getURLParameter('ScCid');

        if (urlScCid) {
            // 如果 URL 有参数，保存到 localStorage
            localStorage.setItem('sc_cid', urlScCid);
        }

        // 从 localStorage 获取并解码
        const scCid = localStorage.getItem('sc_cid');
        const decodedScCid = scCid ? safeDecode(scCid) : null;

        // 构造跳转 URL
        let redirectUrl = 'https://nmttrack.com/?a=146518&o=168172&c=0&co=194328&mt=24&s1=snapchat';

        if (decodedScCid) {
            redirectUrl += `&s5=${encodeURIComponent(decodedScCid)}`;
        }

        // 执行跳转
        window.location.href = redirectUrl;
    })();
</script>
